{"version":3,"file":"fuzzify-pashto.es5.js","sources":["../src/fuzzify-pashto.ts"],"sourcesContent":["/**\n * Copyright (c) openpashto.com\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\ninterface FuzzifyOptions {\n  globalMatch?: boolean;\n  matchStart?: string;\n  matchWholeWordOnly?: boolean;\n  allowSpacesInWords?: boolean;\n  returnWholeWord?: boolean;\n}\n\n// Arabic punctuation to exclude\n// ، \\u060c ؟ \\u061f ؛ \\u061b ۔ \\u06d4\n// Digits etc. exclude \\u0660 - \\u066f\n\nconst pashtoCharacterRange = \"\\u0621-\\u065f\\u0670-\\u06d3\\u06d5\";\n// ISSUE: This does not work if the word is starting with a non-Pashto character like \" or « or .\n// I don't know how to solve this without lookbehinds in JavaScript (not available on all platforms)\n// Need to try all these ideas: https://stackoverflow.com/questions/641407/javascript-negative-lookbehind-equivalent\nconst pashtoWordBoundaryBeginning = `(^|[^${pashtoCharacterRange}])`;\n// TODO: Deal with diacritics etc.\n// .replace(/[\\u0600-\\u061e\\u064c-\\u0670\\u06D6-\\u06Ed]/g, '');\n\n// TOOD: handle \"\" input\n\n// TODO: add southern ش س (at beginning of word?)\n\nconst sSounds = \"صسثڅ\";\nconst zSounds = \"زضظذځژ\";\nconst tdSounds = \"طتټدډ\";\nconst velarPlosives = \"ګږکقگك\";\nconst rLikeSounds = \"رړڑڼ\";\nconst labialPlosivesAndFricatives = \"فپب\";\n// Includes Arabic ى \\u0649  \nconst theFiveYeys = \"ېۍیيئےى\";\n\nconst pashtoReplacer = {\n  \"ا\": \"اآهع\", // TODO: make optional (if not at the beginning of word)\n  \"آ\": \"اآه\",\n  \"ٱ\": \"اآه\",\n  \"ٲ\": \"اآه\",\n  \"ٳ\": \"اآه\",\n\n  \"ی\": theFiveYeys,\n  \"ي\": theFiveYeys,\n  \"ې\": theFiveYeys,\n  \"ۍ\": theFiveYeys,\n  \"ئ\": theFiveYeys,\n  \"ے\": theFiveYeys,\n\n  \"س\": sSounds,\n  \"ص\": sSounds,\n  \"ث\": sSounds,\n  \"څ\": sSounds,\n\n  \"ج\": \"چجڅ\", \n  \"چ\": \"چجڅ\",\n  \n  \"ه\": \"اهحہ\",\n  \"ۀ\": \"اهحہ\",\n  \"ہ\": \"اهحہ\",\n\n  \"ع\": \"اوع\", // TODO: make optional\n  \"و\": \"وع\", // TODO: make optional (and if at the beginning of a word precede with an ا)\n  \"ؤ\": \"وع\",\n  \n  \"ښ\": \"ښخشخهحغ\",\n  \"غ\": 'ښخشخهحغ',\n  \"خ\": 'ښخشخهحغ',\n  \"ح\": 'ښخشخهحغ',\n\n  \"ش\": 'شښ',\n\n  \"ز\": zSounds,\n  \"ض\": zSounds,\n  \"ذ\": zSounds,\n  \"ځ\": zSounds,\n  \"ظ\": zSounds,\n\n  \"ژ\": 'زضظژذځږ',\n\n  \"ر\": rLikeSounds,\n  \"ړ\": rLikeSounds,\n  \"ڑ\": rLikeSounds,\n\n  \"ت\": tdSounds,\n  \"ټ\": tdSounds,\n  \"ٹ\": tdSounds,\n  \"ط\": tdSounds,\n  \"د\": tdSounds,\n  \"ډ\": tdSounds,\n  \"ڈ\": tdSounds,\n\n  \"نب\": 'نبم',\n  \"ن\": 'نڼ',\n  \"ڼ\": 'نڼړڑ',\n\n  \"ک\": velarPlosives,\n  \"ګ\": velarPlosives,\n  \"گ\": velarPlosives,\n  \"ق\": velarPlosives,\n\n  \"ږ\": velarPlosives + 'ژ',\n\n  \"ب\": labialPlosivesAndFricatives,\n  \"پ\": labialPlosivesAndFricatives,\n  \"ف\": labialPlosivesAndFricatives,\n}\n\nconst thingsToReplace = Object.keys(pashtoReplacer);\nconst pashtoReplacerRegex = new RegExp(thingsToReplace.reduce((accumulator, currentValue, i) => {\n  if (i === thingsToReplace.length - 1) {\n    return accumulator + currentValue; \n  } \n  return accumulator + currentValue + \"|\";\n}, \"\"), \"g\");\n\nexport function fuzzifyPashto(input: string, options: FuzzifyOptions = {}): RegExp {\n  let safeInput = input.replace(/[#-.]|[[-^]|[?|{}]/g, '');\n  if (options.allowSpacesInWords) {\n    safeInput = safeInput.replace(/ /g, '');\n  }\n  const regexLogic = safeInput.trim().replace(pashtoReplacerRegex, (mtch) => {\n    return `[${pashtoReplacer[mtch]}]${options.allowSpacesInWords ? '\\ ?' : ''}`\n  });\n  // Set how to begin the matching (default at the beginning of a word)\n  let beginning = options.matchStart === \"string\" ? \"^\" :\n                    options.matchStart === \"anywhere\" ? \"\" :\n                    pashtoWordBoundaryBeginning; // \"word\" is the default\n  let ending = \"\";\n  if (options.matchWholeWordOnly) {\n    if (options.matchStart === \"anywhere\") beginning = pashtoWordBoundaryBeginning;\n    ending = `(?![${pashtoCharacterRange}])`;\n  }\n  // If they're already using matchWholeWordOnly, don't change it\n  if (options.returnWholeWord && !options.matchWholeWordOnly) {\n    ending = `[${pashtoCharacterRange}]*(?![${pashtoCharacterRange}])`;\n    if (options.matchStart === \"anywhere\") {\n      beginning = `${pashtoWordBoundaryBeginning}[${pashtoCharacterRange}]*`; \n    }\n  }\n  const flags = `m${options.globalMatch === false ? '' : 'g'}`;\n  return new RegExp(`${beginning}${regexLogic}${ending}`, flags);\n}\n  "],"names":[],"mappings":"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"}